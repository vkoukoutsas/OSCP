# 5. ‚Äê Vulnerability  Scanning

##### p. 119

Vulnerability scanning is the process of using automated tools to discover, and identify, vulnerabilities in a network. Vulnerability scanners come in many different forms, from simple scripts that identify a single vulnerability, to complex commercial software engines that scan for thousands of them.

## 5.1 - Vulnerability Scanning with Nmap

The Nmap NSE scripts can be used, not only for enumeration, but also to conduct precise vulnerability scanning. All NSE scripts are located in the **/usr/share/nmap/sripts** folder.

```
root@kali:~# ls -l *vuln* /usr/share/nmap/scripts/
ls: cannot access '*vuln*': No such file or directory
/usr/share/nmap/scripts/:
total 4092
-rw-r--r-- 1 root root  3901 Mar 31  2016 acarsd-info.nse
-rw-r--r-- 1 root root  8777 Mar 31  2016 address-info.nse
-rw-r--r-- 1 root root  3345 Mar 31  2016 afp-brute.nse
-rw-r--r-- 1 root root  6891 Mar 31  2016 afp-ls.nse
-rw-r--r-- 1 root root  7001 Mar 31  2016 afp-path-vuln.nse
-rw-r--r-- 1 root root  5671 Mar 31  2016 afp-serverinfo.nse
-rw-r--r-- 1 root root  2621 Mar 31  2016 afp-showmount.nse
-rw-r--r-- 1 root root  2262 Mar 31  2016 ajp-auth.nse
-rw-r--r-- 1 root root  2909 Mar 31  2016 ajp-brute.nse
-rw-r--r-- 1 root root  1329 Mar 31  2016 ajp-headers.nse
						...
```

We can use the **[http-vuln-cve2010-2861](https://nmap.org/nsedoc/scripts/http-vuln-cve2010-2861.html)** script to scan a Cold Fusion web server for a directory traversal vulnerability.

```
root@kali:~# nmap -v -p 80 --script=http-vuln-cve2010-2861 10.0.0.1
```

We van see in the above output that not only did Nmap find the server to be vulnerable; it also retrieve the admin's password hash.

The **ftp-anon** NSE script let us quickly scan a range of IP addresses for FTP servers that allow anonymous access.

```
root@kali:~# nmap -v -p 21 --script=ftp-anon.nse 10.0.0.1
```

As was previously mentioned, the Microsoft Windows SMB service has a long history of serious vulnerabilities, and servers are often found to be vulnerable inpenetration test. SMB can often disclose a great deal of information to unauthenticated users, which can then be used for future attacks. For instance, we can check the security level of an SMB server with the **smb-security-mode** NSE script, as follows.

```
root@kali:~# nmap -v -p 139, 455 --script=smb-security-mode 10.0.0.1
```

Beyond penetration testing, network administrators can also benefit from NSE scripts, by verifiying that patches have been applied against a group of servers or workstations.
For example, you can use **nmap** data to verify that all domain web servers have been patched against **[CVE-2011-3192](https://nvd.nist.gov/vuln/detail?vulnId=CVE-2011-3192)**, an Apache denial of service vulnerability.

```
root@kali:~# nmap -v -p 80 --script=http-vuln-cve2011-3192 10.0.0.1-254
```

Nmap also provides links to various references that the user can visit for more information about the discovery vulnerability.

## 5.2 - The Open VAS Vulnerability Scanner

The Open Vulnerability Assessement System ([OpenVAS](http://openvas.org/)) is a powerful vulnerability scanner, containing thousands of vulnerability checks. It is completely free, and open source.